{{ $src := .Get "src" }}
{{ $input_label := .Get "label" | htmlEscape | default "DrawIO Exercise" }} 
{{ $input_name := $input_label | lower | replaceRE "[^0-9a-z]" "_" | replaceRE "-+" "_" }}
{{ $drawio_id := printf "%s%s" "drawio" (md5 (printf "%s%s" $src $input_name)) }}
{{ $pageDir := replace $.Page.File.Dir "\\" "/" }}

{{ if (not .Page.Site.Params.devStage) }}
{{ $src = printf "%s/res/%s%s" .Page.Site.BaseURL $pageDir $src }}
{{ end }}

<div id="{{ $drawio_id }}" class="drawio-exercise-container" devstage="{{ .Page.Site.Params.devStage }}">

<div class="input-row wide">
    <label for="drawio-input">{{ $input_label }}</label>
    <div class="drawio-previewer" title="Click to edit image">
        <object class="drawio-object input" name="drawio_{{ $input_name }}" type="image/svg+xml" data="{{ $src }}" ></object>
        <div class="btn_wrapper_horizontal">
            <button class="drawio-link" onclick="editDrawIO(event, this)" href="#">
                <div style="width: 26px; height: 26px; margin-right: 3px">
                    <svg viewBox="0 80 240 26" preserveAspectRatio="xMidYMid meet" width="100%" height="100%">
                        <path d="M223.49,110.83h-36.07l-34.64-34.64h8.34c5.13,0,9.31-4.16,9.31-9.27V9.35c0-5.15-4.17-9.35-9.31-9.35H71.63c-5.11,0-9.27,4.19-9.27,9.35v57.56c0,5.12,4.16,9.28,9.27,9.28h7.12l-34.64,34.64H9.27c-5.11,0-9.27,4.19-9.27,9.35v57.56c0,5.11,4.16,9.28,9.27,9.28H98.75c5.13,0,9.31-4.16,9.31-9.27v-57.57c0-5.15-4.17-9.35-9.31-9.35h-27.77l34.64-34.64h20.29l34.64,34.64h-26.55c-5.11,0-9.27,4.19-9.27,9.35v57.56c0,5.11,4.16,9.28,9.27,9.28h89.49c5.13,0,9.31-4.16,9.31-9.27v-57.57c0-5.15-4.18-9.35-9.31-9.35Zm-9.31,18.61v39.03h-70.84v-39.03h70.84Zm-124.73,0v39.03H18.61v-39.03H89.45ZM151.81,18.61V57.64H80.97V18.61h70.84Z"/>
                    </svg>
                </div>
                <span>
                    Edit in DrawIO
                </span>
            </button>
            <button class="drawio-link drawio-reset" onclick="resetDrawIO(event, this, '{{ $src }}')" href="#">
                <span>
                    Reset
                </span>
            </button>
        </div>
    </div>
</div>

</div>
